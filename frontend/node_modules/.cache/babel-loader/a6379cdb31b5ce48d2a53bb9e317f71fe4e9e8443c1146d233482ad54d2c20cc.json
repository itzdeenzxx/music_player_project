{"ast":null,"code":"import axios from 'axios';\naxios.defaults.withCredentials = true;\nexport default {\n  name: \"CartShow\",\n  data() {\n    return {\n      cart: [],\n      //รับข้อมูล Master\n      cartDtl: [],\n      //รับข้อมูล Detail\n      cartId: null,\n      memEmail: null,\n      cusId: null\n    };\n  },\n  async mounted() {\n    // ตรวจสอบว่าเป็นเจ้าของตะกร้าหรือไม่\n    await this.chkSession();\n    this.cartId = this.$route.params.cartId;\n    // อ่านข้อมูล Master +อ่านข้อมูล Detail \n    await this.getCart();\n    await this.getCartDtl();\n  },\n  methods: {\n    // แปลงรูปแบบวันที่\n    formattedDate(dateStr) {\n      const date = new Date(dateStr);\n      const year = date.getFullYear();\n      const month = String(date.getMonth() + 1).padStart(2, '0'); // เดือนเริ่มต้นที่ 0, จึงต้อง +1\n      const day = String(date.getDate()).padStart(2, '0');\n      return `${year}-${month}-${day}`;\n    },\n    // Master\n    async getCart() {\n      console.log('Get Cart');\n      await axios.get(`http://localhost:3000/carts/getcart/${this.cartId}`).then(res => {\n        console.log(\"Cart \\n\" + res.data);\n        this.cart = res.data;\n        this.cusId = res.data[0].cusId;\n      }).catch(err => {\n        console.error(err);\n      });\n    },\n    // Detail\n    async getCartDtl() {\n      console.log('Get CartCartDtl');\n      await axios.get(`http://localhost:3000/carts/getcartdtl/${this.cartId}`).then(res => {\n        console.log(\"CartDtl \\n\" + res.data);\n        this.cartDtl = res.data;\n      }).catch(err => {\n        console.error(err);\n      });\n    },\n    // ตรวจสอบ Session\n    async chkSession() {\n      await axios.get(`http://localhost:3000/members/getss`).then(res => {\n        console.log(res.data);\n        this.memEmail = res.data.email;\n      }).catch(err => {\n        console.error(err);\n      });\n    }\n  }\n};","map":{"version":3,"names":["axios","defaults","withCredentials","name","data","cart","cartDtl","cartId","memEmail","cusId","mounted","chkSession","$route","params","getCart","getCartDtl","methods","formattedDate","dateStr","date","Date","year","getFullYear","month","String","getMonth","padStart","day","getDate","console","log","get","then","res","catch","err","error","email"],"sources":["D:\\Users\\Student\\Desktop\\123\\project_webtech\\frontend\\src\\components\\CartShow.vue"],"sourcesContent":["<template>\r\n    <!-- Master --><!-- ถ้าค่าที่อยู่ใน Session กับ CusId ไม่ตรงกันแสดงว่าไม่ใช้ผู้ซื้อไม่มีสิทธิอ่าน -->\r\n    <div v-if=\"memEmail==cusId\">\r\n        <div v-for=\"(ct, cartId) in cart\" :key=\"cartId\" class=\"mt-5\">\r\n            <div class=\"card bg-light\">\r\n                <div class=\"card-body\">\r\n                    <h4 class=\"card-title text-primary opacity-75\">คำสั่งซื้อเลขที่ {{ ct.cartId }}</h4>\r\n                    <h5 class=\"card-subtitle mt-2 text-muted\">\r\n                        สั่งซื้อวันที่ {{ formattedDate(ct.cartDate) }}\r\n                    </h5>\r\n                    <div class=\"text-danger text-end\">\r\n                        จำนวนสินค้า {{ ct.sqty }}ชิ้น, ยอดเงิน {{ ct.sprice.toLocaleString() }} บาท\r\n                    </div>\r\n                    <hr />\r\n                    <a class=\"btn btn-danger\" onclick=\"return confirm('ยืนยันลบตะกร้า')\">\r\n                        <i class=\"bi-cart-x-fill\"></i> ลบตะกร้าสินค้า\r\n                    </a>\r\n                    <a class=\"btn btn-primary float-end\" onclick=\"return confirm('ยืนยันสั่งสินค้า')\">\r\n                        <i class=\"bi-currency-dollar\"></i> ยืนยันสั่งสินค้า\r\n                    </a>\r\n                </div>\r\n            </div> <!--card-->\r\n        </div> <!---v for  -->\r\n   \r\n        <!-- Detail -->\r\n        <table class=\"table  mt-3 \">\r\n            <tr class=\"bg-secondary bg-opacity-10\">\r\n                <td></td>\r\n                <td>สินค้า</td>\r\n                <td></td>\r\n                <td class=\"text-end\">ราคาต่อหน่วย</td>\r\n                <td class=\"text-center\">จำนวน</td>\r\n                <td class=\"text-end\">เป็นเงิน</td>\r\n                <td></td>\r\n            </tr>\r\n            <tr v-for=\"(ctd, pdId) in cartDtl\" :key=\"pdId\">\r\n                <td>{{ ctd.row_number }}</td>\r\n                <td>{{ ctd.pdId }}</td>\r\n                <td>{{ ctd.pdName }}</td>\r\n                <td class=\"text-end\">{{ ctd.price }}</td>\r\n                <td class=\"text-center\">{{ ctd.qty }}</td>\r\n                <td class=\"text-end\">{{ (ctd.price * ctd.qty).toLocaleString() }}</td>\r\n                <td class=\"text-center\">\r\n                    <i class=\"bi-x-lg text-danger\"></i>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div><!--v-if-->\r\n    <div v-else>\r\n        <div class=\"alert alert-danger mt-5\">คุณไม่มีสิทธิ์ดูรายการนี้</div>\r\n    </div>\r\n</template>\r\n<script>\r\nimport axios from 'axios';\r\naxios.defaults.withCredentials = true\r\nexport default {\r\n    name: \"CartShow\",\r\n    data() {\r\n        return {\r\n            cart: [],//รับข้อมูล Master\r\n            cartDtl: [], //รับข้อมูล Detail\r\n            cartId: null,\r\n            memEmail: null,\r\n            cusId:null\r\n        }\r\n    }, \r\n    async mounted() {\r\n        // ตรวจสอบว่าเป็นเจ้าของตะกร้าหรือไม่\r\n        await this.chkSession()\r\n        this.cartId = this.$route.params.cartId\r\n        // อ่านข้อมูล Master +อ่านข้อมูล Detail \r\n        await this.getCart()\r\n        await this.getCartDtl()\r\n    },\r\n    methods: {\r\n        // แปลงรูปแบบวันที่\r\n        formattedDate(dateStr) {\r\n            const date = new Date(dateStr);\r\n            const year = date.getFullYear();\r\n            const month = String(date.getMonth()+ 1).padStart(2, '0'); // เดือนเริ่มต้นที่ 0, จึงต้อง +1\r\n            const day = String(date.getDate()).padStart(2, '0');\r\n            return `${year}-${month}-${day}`;\r\n        },\r\n        // Master\r\n        async getCart() {\r\n            console.log('Get Cart')\r\n            await axios.get(`http://localhost:3000/carts/getcart/${this.cartId}`)\r\n                .then(res => {\r\n                    console.log(\"Cart \\n\" + res.data)\r\n                    this.cart = res.data\r\n                    this.cusId = res.data[0].cusId\r\n                })\r\n                .catch(err => {\r\n                    console.error(err);\r\n                });\r\n        },\r\n        // Detail\r\n        async getCartDtl() {\r\n            console.log('Get CartCartDtl')\r\n            await axios.get(`http://localhost:3000/carts/getcartdtl/${this.cartId}`)\r\n                .then(res => {\r\n                    console.log(\"CartDtl \\n\" + res.data)\r\n                    this.cartDtl = res.data\r\n                })\r\n                .catch(err => {\r\n                    console.error(err);\r\n                });\r\n        },\r\n        // ตรวจสอบ Session\r\n        async chkSession() {\r\n            await axios.get(`http://localhost:3000/members/getss`)\r\n            .then(res => {\r\n                console.log(res.data)\r\n                this.memEmail = res.data.email\r\n            })\r\n            .catch(err => {\r\n                console.error(err);\r\n            });\r\n        }\r\n    }\r\n}\r\n</script>\r\n<style scoped>\r\n.card {\r\n    border-radius: 15px;\r\n    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\r\n    transition: transform 0.2s;\r\n}\r\n\r\n.card:hover {\r\n    transform: translateY(-5px);\r\n}\r\n\r\n.card-title {\r\n    font-size: 1.5rem;\r\n}\r\n\r\n.card-body {\r\n    padding: 20px;\r\n}\r\n\r\n.table {\r\n    margin-top: 20px;\r\n    border-collapse: collapse;\r\n}\r\n\r\n.table th, .table td {\r\n    padding: 12px;\r\n    border: 1px solid #ddd;\r\n}\r\n\r\n.table th {\r\n    background-color: #f8f9fa;\r\n}\r\n\r\n.text-danger {\r\n    color: #dc3545;\r\n}\r\n\r\n.btn {\r\n    border-radius: 20px;\r\n    padding: 10px 15px;\r\n    transition: background-color 0.3s, transform 0.2s;\r\n}\r\n\r\n.btn-danger {\r\n    background-color: #dc3545;\r\n    color: white;\r\n}\r\n\r\n.btn-danger:hover {\r\n    background-color: #c82333;\r\n    transform: scale(1.05);\r\n}\r\n\r\n.btn-primary {\r\n    background-color: #007bff;\r\n    color: white;\r\n}\r\n\r\n.btn-primary:hover {\r\n    background-color: #0069d9;\r\n    transform: scale(1.05);\r\n}\r\n\r\n.alert {\r\n    border-radius: 15px;\r\n    padding: 20px;\r\n    font-size: 1.1rem;\r\n}\r\n\r\n.text-muted {\r\n    font-size: 0.9rem;\r\n}\r\n\r\n.text-end {\r\n    text-align: right;\r\n}\r\n\r\n.text-center {\r\n    text-align: center;\r\n}\r\n\r\n.mt-5 {\r\n    margin-top: 3rem;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}