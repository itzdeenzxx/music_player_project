{"ast":null,"code":"import { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"row\"\n};\nconst _hoisted_2 = {\n  class: \"col-md-6 col-sm-12\"\n};\nconst _hoisted_3 = {\n  class: \"card mx-auto\",\n  style: {\n    \"width\": \"18rem\"\n  }\n};\nconst _hoisted_4 = [\"src\"];\nconst _hoisted_5 = {\n  class: \"col-md-6 col-sm-12\"\n};\nconst _hoisted_6 = {\n  class: \"table\"\n};\nconst _hoisted_7 = {\n  class: \"table-secondary\"\n};\nconst _hoisted_8 = /*#__PURE__*/_createElementVNode(\"td\", null, [/*#__PURE__*/_createElementVNode(\"h5\", null, \"ราคา\")], -1 /* HOISTED */);\nconst _hoisted_9 = /*#__PURE__*/_createElementVNode(\"td\", null, [/*#__PURE__*/_createElementVNode(\"h5\", null, \"ยี่ห้อ\")], -1 /* HOISTED */);\nconst _hoisted_10 = /*#__PURE__*/_createElementVNode(\"td\", null, [/*#__PURE__*/_createElementVNode(\"h5\", null, \"รายละเอียด\")], -1 /* HOISTED */);\nconst _hoisted_11 = /*#__PURE__*/_createElementVNode(\"i\", {\n  class: \"bi bi-cart lead\"\n}, null, -1 /* HOISTED */);\nconst _hoisted_12 = /*#__PURE__*/_createElementVNode(\"button\", {\n  class: \"btn btn-warning float-end\"\n}, [/*#__PURE__*/_createElementVNode(\"i\", {\n  class: \"bi bi-pencil-fill lead\"\n}), /*#__PURE__*/_createTextVNode(\" แก้ไข   \")], -1 /* HOISTED */);\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.products, (pd, pd_id) => {\n    return _openBlock(), _createElementBlock(\"div\", {\n      key: pd_id,\n      class: \"mt-5\"\n    }, [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"img\", {\n      src: `http://localhost:3000/img_pd/${pd.pd_id}.jpg`,\n      alt: \"\"\n    }, null, 8 /* PROPS */, _hoisted_4)])]), _createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"table\", _hoisted_6, [_createElementVNode(\"tr\", _hoisted_7, [_createElementVNode(\"td\", null, [_createElementVNode(\"h4\", null, _toDisplayString(pd.pd_id), 1 /* TEXT */)]), _createElementVNode(\"td\", null, [_createElementVNode(\"h4\", null, _toDisplayString(pd.pd_name), 1 /* TEXT */)])]), _createElementVNode(\"tr\", null, [_hoisted_8, _createElementVNode(\"td\", null, [_createElementVNode(\"h5\", null, _toDisplayString(pd.pd_price), 1 /* TEXT */)])]), _createElementVNode(\"tr\", null, [_hoisted_9, _createElementVNode(\"td\", null, [_createElementVNode(\"h5\", null, _toDisplayString(pd.thebrand.brand_name), 1 /* TEXT */)])]), _createElementVNode(\"tr\", null, [_hoisted_10, _createElementVNode(\"td\", null, [_createElementVNode(\"h5\", null, _toDisplayString(pd.pd_remark), 1 /* TEXT */)])])]), _createElementVNode(\"button\", {\n      class: \"btn btn-primary\",\n      onClick: _cache[0] || (_cache[0] = (...args) => $options.chkLogin && $options.chkLogin(...args))\n    }, [_hoisted_11, _createTextVNode(\" ใส่ตะกร้า  \")]), _hoisted_12])])]);\n  }), 128 /* KEYED_FRAGMENT */);\n}","map":{"version":3,"names":["class","style","_createElementVNode","_createTextVNode","_createElementBlock","_Fragment","_renderList","$data","products","pd","pd_id","key","_hoisted_1","_hoisted_2","_hoisted_3","src","alt","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_toDisplayString","pd_name","_hoisted_8","pd_price","_hoisted_9","thebrand","brand_name","_hoisted_10","pd_remark","onClick","_cache","args","$options","chkLogin","_hoisted_11","_hoisted_12"],"sources":["D:\\Users\\Student\\Desktop\\123\\project_webtech\\frontend\\src\\components\\ProductShow.vue"],"sourcesContent":["<template>\r\n    <div v-for=\"(pd, pd_id) in products\" :key=\"pd_id\" class=\"mt-5\">\r\n        <div class=\"row\">\r\n            <div class=\"col-md-6 col-sm-12\">\r\n                <div class=\"card mx-auto\" style=\"width: 18rem\">\r\n                    <img :src=\"`http://localhost:3000/img_pd/${pd.pd_id}.jpg`\" alt=\"\">\r\n                </div>\r\n            </div>\r\n            <div class=\"col-md-6 col-sm-12\">\r\n                <table class=\"table\">\r\n                    <tr class=\"table-secondary\">\r\n                        <td><h4>{{ pd.pd_id }}</h4></td>\r\n                        <td><h4>{{ pd.pd_name }}</h4></td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td><h5>ราคา</h5></td>\r\n                        <td><h5>{{ pd.pd_price }}</h5></td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td><h5>ยี่ห้อ</h5></td>\r\n                        <td><h5>{{ pd.thebrand.brand_name }}</h5></td>\r\n                    </tr>\r\n                    <tr>\r\n                        <td><h5>รายละเอียด</h5></td>\r\n                        <td><h5>{{ pd.pd_remark }}</h5></td>\r\n                    </tr>\r\n                </table>\r\n                <button class=\"btn btn-primary\" @click=\"chkLogin\">\r\n                    <i class=\"bi bi-cart lead\"></i> ใส่ตะกร้า&nbsp;\r\n                </button>\r\n                <button class=\"btn btn-warning float-end\">\r\n                    <i class=\"bi bi-pencil-fill lead\"></i> แก้ไข&nbsp;&nbsp;\r\n                </button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios';\r\nimport { EventBus } from \"../event-bus\";\r\n\r\naxios.defaults.withCredentials = true;\r\n\r\nexport default {\r\n    name: 'ProductShow',\r\n    data() {\r\n        return {\r\n            products: [],\r\n            id: null,\r\n            memEmail: null,\r\n            cartId: null,\r\n            backendMessage: ''\r\n        };\r\n    },\r\n    mounted() {\r\n        this.id = this.$route.params.pd_id;\r\n        this.fetchProduct();\r\n    },\r\n    \r\n    methods: {\r\n        async fetchProduct() {\r\n            try {\r\n                const response = await axios.get(`http://localhost:3000/products/${this.id}`);\r\n                this.products = response.data;\r\n            } catch (err) {\r\n                console.error(err);\r\n                alert('Failed to load product data.');\r\n            }\r\n        },\r\n\r\n        async chkLogin() {\r\n            await this.chkSession();\r\n            if (!this.memEmail) {\r\n                alert(\"ต้อง Login เข้าระบบก่อน\");\r\n                return;\r\n            }\r\n            await this.chkCart();\r\n            if (!this.cartId) {\r\n                await this.addCart();\r\n            }\r\n            this.addCartDtl();\r\n        },\r\n\r\n        async chkSession() {\r\n            try {\r\n                const response = await axios.get(`http://localhost:3000/members/getss`);\r\n                this.memEmail = response.data.email;\r\n            } catch (err) {\r\n                console.error(err);\r\n                alert('Session check failed.');\r\n            }\r\n        },\r\n\r\n        async addCart() {\r\n            try {\r\n                const customer = { cusId: this.memEmail };\r\n                const response = await axios.post(`http://localhost:3000/carts/addcart`, customer);\r\n                this.backendMessage = response.data.messageAddCart;\r\n                this.cartId = response.data.messageAddCart;\r\n            } catch (err) {\r\n                console.error(err);\r\n                alert('Failed to create cart.');\r\n            }\r\n        },\r\n\r\n        async chkCart() {\r\n            try {\r\n                const response = await axios.get(`http://localhost:3000/carts/chkcart`);\r\n                this.cartId = response.data.id;\r\n            } catch (err) {\r\n                console.error(err);\r\n                alert('Failed to check cart.');\r\n            }\r\n        },\r\n\r\n        async addCartDtl() {\r\n            const cartdtl = {\r\n                cartId: this.cartId,\r\n                pdId: this.id,\r\n                pdPrice: this.products[0].pd_price\r\n            };\r\n            try {\r\n                const response = await axios.post(`http://localhost:3000/carts/addcartdtl`, cartdtl);\r\n                EventBus.emit('cartdtlOK');\r\n                this.backendMessage = response.data.messageAddCartDtl;\r\n            } catch (err) {\r\n                console.error(err);\r\n                alert('Failed to add product to cart.');\r\n            }\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style>\r\n/* Add relevant styles here */\r\n</style>"],"mappings":";;EAEaA,KAAK,EAAC;AAAK;;EACPA,KAAK,EAAC;AAAoB;;EACtBA,KAAK,EAAC,cAAc;EAACC,KAAoB,EAApB;IAAA;EAAA;;mBAJ1C;;EAQiBD,KAAK,EAAC;AAAoB;;EACpBA,KAAK,EAAC;AAAO;;EACZA,KAAK,EAAC;AAAiB;gCAKvBE,mBAAA,CAAsB,a,aAAlBA,mBAAA,CAAa,YAAT,MAAI,E;gCAIZA,mBAAA,CAAwB,a,aAApBA,mBAAA,CAAe,YAAX,QAAM,E;iCAIdA,mBAAA,CAA4B,a,aAAxBA,mBAAA,CAAmB,YAAf,YAAU,E;iCAKtBA,mBAAA,CAA+B;EAA5BF,KAAK,EAAC;AAAiB;iCAE9BE,mBAAA,CAES;EAFDF,KAAK,EAAC;AAA2B,I,aACrCE,mBAAA,CAAsC;EAAnCF,KAAK,EAAC;AAAwB,I,aA/BrDG,gBAAA,CA+B0D,WAC1C,E;;2BA/BZC,mBAAA,CAkCMC,SAAA,QAnCVC,WAAA,CAC+BC,KAAA,CAAAC,QAAQ,EADvC,CACiBC,EAAE,EAAEC,KAAK;yBAAtBN,mBAAA,CAkCM;MAlCgCO,GAAG,EAAED,KAAK;MAAEV,KAAK,EAAC;QACpDE,mBAAA,CAgCM,OAhCNU,UAgCM,GA/BFV,mBAAA,CAIM,OAJNW,UAIM,GAHFX,mBAAA,CAEM,OAFNY,UAEM,GADFZ,mBAAA,CAAkE;MAA5Da,GAAG,kCAAkCN,EAAE,CAACC,KAAK;MAAQM,GAAG,EAAC;4BALnFC,UAAA,E,KAQYf,mBAAA,CAyBM,OAzBNgB,UAyBM,GAxBFhB,mBAAA,CAiBQ,SAjBRiB,UAiBQ,GAhBJjB,mBAAA,CAGK,MAHLkB,UAGK,GAFDlB,mBAAA,CAAgC,aAA5BA,mBAAA,CAAuB,YAAAmB,gBAAA,CAAhBZ,EAAE,CAACC,KAAK,iB,GACnBR,mBAAA,CAAkC,aAA9BA,mBAAA,CAAyB,YAAAmB,gBAAA,CAAlBZ,EAAE,CAACa,OAAO,iB,KAEzBpB,mBAAA,CAGK,aAFDqB,UAAsB,EACtBrB,mBAAA,CAAmC,aAA/BA,mBAAA,CAA0B,YAAAmB,gBAAA,CAAnBZ,EAAE,CAACe,QAAQ,iB,KAE1BtB,mBAAA,CAGK,aAFDuB,UAAwB,EACxBvB,mBAAA,CAA8C,aAA1CA,mBAAA,CAAqC,YAAAmB,gBAAA,CAA9BZ,EAAE,CAACiB,QAAQ,CAACC,UAAU,iB,KAErCzB,mBAAA,CAGK,aAFD0B,WAA4B,EAC5B1B,mBAAA,CAAoC,aAAhCA,mBAAA,CAA2B,YAAAmB,gBAAA,CAApBZ,EAAE,CAACoB,SAAS,iB,OAG/B3B,mBAAA,CAES;MAFDF,KAAK,EAAC,iBAAiB;MAAE8B,OAAK,EAAAC,MAAA,QAAAA,MAAA,UAAAC,IAAA,KAAEC,QAAA,CAAAC,QAAA,IAAAD,QAAA,CAAAC,QAAA,IAAAF,IAAA,CAAQ;QAC5CG,WAA+B,EA5BnDhC,gBAAA,CA4BmD,cACnC,E,GACAiC,WAES,C","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}